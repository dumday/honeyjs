/*
|--------------------------------------------------------------------------
| An open source Javascript Honey Pot implementation
|--------------------------------------------------------------------------
|
| @version 1.1.0
| @author Zudd ( Hung Luu )
| @url https://github.com/zudd/honeyjs
| @license The MIT License (MIT)
|
| Copyright (c) 2015 Hung Luu
*/
var honey=function(){var e,b,d;e={theme:"light",type:"image",size:"normal",time:6,holderClass:"honeyjs",key:null,forceCaptcha:!1};b={getForms:function(){return document.getElementsByTagName("form")},now:function(){return Date.now?Date.now():(new Date).getTime()},installReCaptchaCallbacks:function(a,c){c.callback=function(c){a.save(c)};c["expired-callback"]=function(){a.reset()};return c},activateReCaptchaAutomatically:function(a){function c(){a.activateCaptcha()}setTimeout(c,300);return c},installjQueryPlugin:function(a,c,b){return a?(a.fn[c]=b,!0):!1},find:function(a,c){if(c.indexOf)return c.indexOf(a);for(var b=0,g=c.length;b<g;b++)if(c[b]===a)return b;return-1},contains:function(a,c){return-1!==b.find(a,c)},getHolder:function(a,c){var f;if(a.getElementsByClassName)return f=a.getElementsByClassName(c),f.length?f[0]:a;var g;f=a.getElementsByTagName("*");for(var d=0,e=f.length;d<e;d++)if(g=f[d].className.split(" "),b.contains(c,g))return f[d];return a},hiddenInput:function(a,c){var b=document.createElement("input");b.name=c;b.style.display="none";b.style.visibility="hidden";a.appendChild(b);return b},bind:function(a,c,f,d){function e(a){var c=f.call(d,a);!1===c&&b.cancel(a);return c}a.addEventListener?a.addEventListener(c,e,!1):a.attachEvent("on"+c,e);return e},cancel:function(a){if(a=a||window.event)a.cancelBubble=!0,a.returnValue=!1,a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault();return!1},getInputByName:function(a,c){for(var b=a.getElementsByTagName("input"),d=0,e=b.length;d<e;d++)if(b[d].name===c)return b[d]},isDev:function(){return!navigator.plugins.length},__installDev:function(a){a&&(d.dev=b);return!!a},Collector:function(){},ReCaptcha:function(){this.response=this.id=this.key=this.holder=null},Hook:function(){},Pot:function(a){this.options=e;this.form=a;this.createdAt=b.now();this.holder=b.getHolder(a,e.holderClass);this.empty=b.hiddenInput(this.holder,"name");this.time=b.hiddenInput(this.holder,"_time");this.hooks={};this.hooks.validate=new b.Hook;this.hooks.fail=new b.Hook;this.re=new b.ReCaptcha;b.bind(a,"submit",function(){return this.valid()},this)();this.re.key=this.options.key;e.forceCaptcha&&this.options.key&&b.activateReCaptchaAutomatically(this)},Pots:function(){}};b.Collector.prototype=Array.prototype;b.Collector.prototype.find=function(a){return b.find(a,this)};b.Collector.prototype.has=function(a){return b.contains(a,this)};b.Collector.prototype.remove=function(a){a=this.find(a);var c=-1!==a;c&&this.splice(a,1);return c};b.Collector.prototype.flush=function(){this.length=0};b.Hook.prototype=b.Collector.prototype;b.Hook.prototype.exec=function(a){for(var c=!0,b=0,d=this.length;b<d&&(c=this[b].call(a),!1!==c);b++);return c};b.ReCaptcha.prototype={ready:function(){return null!==this.holder},required:function(){return null!==this.key},load:function(a){"undefined"!==typeof grecaptcha&&this.required()&&!this.ready()&&(this.holder=document.createElement("div"),a.sitekey=this.key,b.installReCaptchaCallbacks(this,a),this.id=grecaptcha.render(this.holder,a));return this.holder},save:function(a){this.response=a},reset:function(){this.key&&this.id&&"undefined"!==typeof grecaptcha&&grecaptcha.reset(this.id)},valid:function(){return this.required()?"undefined"===typeof grecaptcha?!1:this.ready()&&null!==this.response:!0}};b.Pot.prototype={valid:function(){var a=b.now();if(this.hooks.validate.exec(this)&&""===this.empty.value&&!this.fast(a)&&this.re.valid())return this.time.value=a,!0;this.activateCaptcha();this.hooks.fail.exec(this);return!1},name:function(a){a&&(this.empty.name=a);return this.empty.name},validate:function(a){this.hooks.validate.push(a);return this},fail:function(a){this.hooks.fail.push(a);return this},config:function(a){if("string"===typeof a)return this.options[a];for(var b in a)this.options[b]=a[b];return this},captcha:function(a){this.re.key=a||e.key;return this},fast:function(a){a=a||b.now();return a-this.createdAt<=this.options.time},input:function(a){return b.getInputByName(this.form,a)},value:function(a){if(a=this.input(a))return a.value},push:function(a){a&&this.holder.appendChild(a)},activateCaptcha:function(){this.push(this.re.load({theme:this.options.theme,type:this.options.type,size:this.options.size}))}};b.Pots.prototype=b.Collector.prototype;b.Pots.prototype.each=function(a){for(var b=0,d=this.length;b<d;b++)a(this[b]);return this};b.Pots.prototype.captcha=function(a){return this.each(function(b){b.captcha(a)})};b.Pots.prototype.config=function(a){return"string"===typeof a&&this.length?this[0].config(a):this.each(function(b){b.config(a)})};b.Pots.prototype.validate=function(a){return this.each(function(b){b.validate(a)})};b.Pots.prototype.fail=function(a){return this.each(function(b){b.fail(a)})};d=function(a){if("string"===typeof a&&"undefined"!==typeof jQuery)return d(jQuery(a));if(a instanceof HTMLFormElement)return new b.Pot(a);if(1===a.length)return d(a[0]);for(var c=new b.Pots,e=0,g=a.length;e<g;e++)c.push(d(a[e]));return c};d.requireCaptcha=function(a){e.key=a;return e.key};d.forceCaptcha=function(a){e.forceCaptcha=!!d.requireCaptcha(a);return e.forceCaptcha};d.config=function(a){if("string"===typeof a)return e[a];for(var b in a)e[b]=a[b]};d.all=function(){return d(b.getForms())};b.installjQueryPlugin(jQuery,"honey",function(a){var b=d(this);return b&&a?"string"===typeof a?b.captcha(a):b.config(a):b});b.__installDev(b.isDev());return d}();