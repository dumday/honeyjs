/*
|--------------------------------------------------------------------------
| An open source Javascript Honey Pot implementation
|--------------------------------------------------------------------------
|
| @version 1.0.4 - Supporting google reCaptcha
| @author  Zudd ( Hung Luu )
| @url	 https://github.com/zudd/honeyjs
| @license The MIT License (MIT)
|
| Copyright (c) 2015 Hung Luu
*/
var Honey={gkey:"",input:function(a){var b=document.createElement("input");b.style.display="none";b.style.visibility="hidden";b.name=a;return b},now:function(){return(new Date).getTime()},isInt:function(a){if(isNaN(a))return!1;a=parseFloat(a);return(a|0)===a},find:function(a,b){if(Array.prototype.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},contains:function(a,b){return-1!==this.find(a,b)},forms:function(){return document.getElementsByTagName("form")},
cancel:function(a){a=a||window.event;a.cancelBubble=!0;a.returnValue=!1;a.preventDefault&&a.preventDefault();return!1},Pot:function(a){this.form=a;this.input=Honey.input("name");a.appendChild(this.input);this.time=Honey.input("_time");a.appendChild(this.time);this.createTime=Honey.now();var b=this;a.addEventListener?a.addEventListener("submit",function(a){return b.check()?!0:Honey.cancel(a)},!0):a.attachEvent("onsubmit",function(a){return b.check()?!0:Honey.cancel(a)});this.acceptableTime=5;this.captcha=
new Honey.ReCaptcha},ReCaptcha:function(){this.holder=this.gkey=null;this.type="image";this.size="normal";this.theme="light";this.response=null;this.id=0},secure:function(a){return new this.Pot(a)},all:function(){for(var a=this.forms(),b=[],c=0,d=a.length;c<d;c++)b.push(this.secure(a[c]));return b},only:function(a){var b=this.forms(),c=[];a=a||[];if(0<a.length)for(var d=0,e=b.length;d<e;d++)this.contains(a,b[d])&&c.push(this.secure(b[d]));return c},except:function(a){a=a||[];if(0<a.length){for(var b=
this.forms(),c=[],d=0,e=b.length;d<e;d++)this.contains(a,b[d])||c.push(this.secure(b[d]));return c}return this.all()},key:function(a){a&&(this.gkey=a);return this.gkey},captcha:function(a,b){if(a instanceof Honey.Pot)a.captcha.key(b||Honey.key());else for(var c=0,d=a.length;c<d;c++)a[c].captcha.key(b||Honey.key());return a}};
Honey.Pot.prototype={check:function(){var a=Honey.now(),b=this.captcha;if(""===this.input.value&&!this.fast(a)&&b.check())return this.time.value=a,!0;b.key()&&!b.holder&&(b.holder=document.createElement("div"),this.form.appendChild(b.holder),b.id=grecaptcha.render(b.holder,{sitekey:b.gkey,theme:b.theme,type:b.type,size:b.size,callback:function(a){b.save(a)},"expired-callback":function(){b.reset()}}));return!1},name:function(a){"string"===typeof a&&(this.input.name=a);return this.input.name},accept:function(a){Honey.isInt(a)&&
(this.acceptableTime=a);return this.acceptableTime},time:function(a){a&&(this.time.value=a);return this.createTime},fast:function(a){a=a||Honey.now();return a-this.createTime<=this.acceptableTime}};Honey.ReCaptcha.prototype={key:function(a){a&&(this.gkey=a);return this.gkey},save:function(a){this.response=a},check:function(){return this.gkey?null!==this.response:!0},reset:function(){this.gkey&&grecaptcha.reset(this.id)}};