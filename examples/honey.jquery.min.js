/*
|--------------------------------------------------------------------------
| An open source Javascript Honey Pot implementation - JQuery Plugin Edition
|--------------------------------------------------------------------------
|
| @version 1.0.5 - Supporting google reCaptcha
| @author Zudd ( Hung Luu )
| @url https://github.com/zudd/honeyjs
| @license The MIT License (MIT)
|
| Copyright (c) 2015 Hung Luu
*/
(function(c){var d={gkey:"",input:function(a){return c("<input/>",{name:a}).css({display:"none",visibility:"hidden"})},isInt:function(a){if(isNaN(a))return!1;a=parseFloat(a);return(a|0)===a},Pot:function(a){this.holder=this.form=a;var b=a.children(".honeyjs");0<b.length&&(this.holder=c(b[0]));this.input=d.input("name").appendTo(this.holder);this.time=d.input("_time").appendTo(this.holder);this.createTime=c.now();var e=this;a.submit(function(a){if(e.check())return!0;a.preventDefault();return!1});this.acceptableTime=5;this.captcha=new d.ReCaptcha},ReCaptcha:function(){this.holder=this.gkey=null;this.type="image";this.size="normal";this.theme="light";this.response=null;this.id=0},secure:function(a){return new this.Pot(a)},all:function(){var a=[];c("form").each(function(b,e){a.push(d.secure(c(e)))});return a},only:function(a){var b=[];a.each(function(a,f){b.push(d.secure(c(f)))});return b},except:function(a){var b=[],e=a.toArray();c("form").filter(function(){return c.inArray(this,e)}).each(function(a,e){b.push(d.secure(c(e)))});return b},key:function(a){a&&(this.gkey=a);return this.gkey},captcha:function(a,b){a instanceof d.Pot?a.captcha.key(b||d.key()):c.each(a,function(a,c){c.captcha.key(b||d.key())});return a}};d.Pot.prototype={check:function(){var a=c.now(),b=this.captcha;if(""===this.input.val()&&!this.fast(a)&&b.check())return this.time.val(a),!0;b.key()&&!b.holder&&(b.holder=c("<div/>").appendTo(this.holder),b.id=grecaptcha.render(b.holder.get(0),{sitekey:b.gkey,theme:b.theme,type:b.type,size:b.size,callback:function(a){b.save(a)},"expired-callback":function(){b.reset()}}));return!1},name:function(a){"string"===typeof a&&(this.input.name=a);return this.input.name},accept:function(a){d.isInt(a)&&(this.acceptableTime=a);return this.acceptableTime},time:function(a){a&&(this.time.value=a);return this.createTime},fast:function(a){a=a||c.now();return a-this.createTime<=this.acceptableTime}};d.ReCaptcha.prototype={key:function(a){a&&(this.gkey=a);return this.gkey},save:function(a){this.response=a},check:function(){return this.gkey?null!==this.response:!0},reset:function(){this.gkey&&grecaptcha.reset(this.id)}};c.fn.secure=function(){if(0<this.length)return 1===this.length?d.secure(c(this[0])):d.only(c(this))};c.captcha=function(a,b){return d.captcha(a,b)};c.captchaKey=function(a){return d.key(a)};c.secureAll=function(){return d.all()};c.secureOnly=function(a){return d.only(c(a))};c.secureExcept=function(a){return d.except(c(a))}})(jQuery);